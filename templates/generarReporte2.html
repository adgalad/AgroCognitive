{% load staticfiles %}
<!DOCTYPE html>
<html lang="en">
<head>

	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=Edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="keywords" content="">
	<meta name="description" content="">
	<!-- Plotly.js -->
  	<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  	<!-- jquery -->
  	<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

	<title>Información Cultivo | AgroCognitive</title>

	<!-- stylesheet css -->
	<link rel="stylesheet" href="../static/css/bootstrap.min.css">
	<link rel="stylesheet" href="../static/css/font-awesome.min.css">
	<link rel="stylesheet" href="../static/css/nivo-lightbox.css">
	<link rel="stylesheet" href="../static/css/nivo_themes/default/default.css">
	<link rel="stylesheet" href="../static/css/style.css">
	<!-- google web font css -->
	<link href='http://fonts.googleapis.com/css?family=Raleway:400,300,600,700' rel='stylesheet' type='text/css'>

</head>
<body data-spy="scroll" data-target=".navbar-collapse">
	
<!-- navigation -->
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
		<div class="navbar-header">
			<button class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
				<span class="icon icon-bar"></span>
				<span class="icon icon-bar"></span>
				<span class="icon icon-bar"></span>
			</button>
			<a href="{% url 'menuPrincipal' %}" class="navbar-brand smoothScroll">AgroCognitive</a>
		</div>
		<div class="collapse navbar-collapse">
			<ul class="nav navbar-nav navbar-right">
				<li><a href="#contact" class="smoothScroll">Bienvenida, María</a></li>
				<li>
					<div class="hamburger-btn" onclick="openNav()" style="position: relative;top: 25px; left: 30px;">
						<div></div>
						<div></div>
						<div></div>	
					</div>
				</li>
			</ul>
		</div>
		<div id="mySidenav" class="sidenav">
			  <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
			  <a href="#">
			  	<img src="../static/img/cargarImg.png" width="20%" style="margin-right: 10px;">
			  	<h5 style="display: inline-block;">
			  		Cargar imágenes
			  	</h5>
			  </a>
			  <a href="#">
			  	<img src="../static/img/monitorearTerreno.png" width="20%" style="margin-right: 10px;">
			  	<h5 style="display: inline-block;">
			  		Monitorear terrenos
			  	</h5>
			  </a>
			  <a href="#">
			  	<img src="../static/img/monitorearCultivo.png" width="20%" style="margin-right: 10px;">
			  	<h5 style="display: inline-block;">
			  		Monitorear cultivos
			  	</h5>
			  </a>
			  <a href="#">
			  	<img src="../static/img/reporte.png" width="20%" style="margin-right: 10px;">
			  	<h5 style="display: inline-block;">
			  		Generar reportes
			  	</h5>
			  </a>
			  <a href="#">
			  	<img src="../static/img/historico.png" width="20%" style="margin-right: 10px;">
			  	<h5 style="display: inline-block;">
			  		Históricos
			  	</h5>
			  </a>
			</div>
	</div>
</div>		

<!-- service section -->
<div id="reportes">
	<div class="container">
		<div class="row">
			<div class="col-md-12 col-sm-12 text-center">
				<h2>Análisis del terreno</h2>
				<br><br>
				<h4>
					En esta sección podrás encontrar en detalle el estado de tu cultivo.
				</h4>
			</div>
		</div>
		<div class="row">
			<div class="col-sm-6 col-md-6">
				<div id="analisisTerreno" style="width: 450px;"></div>
				<table rules="rows">
					<thead>
						<th></th>
						<th><h4><b>N° de plantas(*)</b></h4></th>
						<th><h4><b>Área en m2 afectada</b></h4></th>
					</thead>
					<tbody>
						<tr>
							<td style="text-align: justify !important;"><h4><b>Plantas Sanas</b></h4></td>
							<td><h4>{{ numP_Sanas|floatformat:"0" }}</h4></td>
							<td><h4>{{ areaSana|floatformat:"2" }}</h4></td>
						</tr>
						<tr>
							<td style="text-align: justify !important;"><h4><b>Plantas Afectadas</b></h4></td>
							<td><h4>{{ numP_Afectadas|floatformat:"0" }}</h4></td>
							<td><h4>{{ areaAfectada|floatformat:"2" }}</h4></td>
						</tr>
					</tbody>
				</table>
				<p>(*) Se toma como referencia en promedio 2000 plantas de café por hectárea.</p>
			</div>
			<div class="col-sm-6 col-md-6">
				<div id="terrenoAfectado" style="width: 500px;"></div>
				<table rules="rows">
					<thead>
						<th></th>
						<th><h4><b>N° de plantas(*)</b></h4></th>
						<th><h4><b>Área afectada (m2)</b></h4></th>
					</thead>
					<tbody>
						<tr>
							<td style="text-align: left !important;"><h4><b>Enfermedades y/o plagas</b></h4></td>
							<td><h4>{{ numP_Plagas|floatformat:"0" }}</h4></td>
							<td><h4>{{ aPlagas|floatformat:"2" }}</h4></td>
						</tr>
						<tr>
							<td style="text-align: left !important;"><h4><b>Falta de nutrientes</b></h4></td>
							<td><h4>{{ numP_Nutrientes|floatformat:"0" }}</h4></td>
							<td><h4>{{ aNutrientes|floatformat:"2" }}</h4></td>
						</tr>
					</tbody>
				</table>
				<p>(*) Se toma como referencia en promedio 2000 plantas de café por hectárea.</p>
			</div>
		</div>
		<div class="container">
			<div class="row">
				<br><br>
				<div class="col-md-1 col-sm-1"></div>
				<div class="col-md-10 col-sm-10">
					<hr>
				</div>
				<div class="col-md-1 col-sm-1"></div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-12 col-sm-12 text-center">
				<h2>Proyección</h2>
				<br><br>
				<h4>
					Dentro del terreno afectado hemos detectado la presencia de plantas de café enfermas por Roya.
					En los siguientes gráficos podrás observar cómo sería el esparcimiento de esta enfermedad dentro
					de tu cultivo bajo condiciones climáticas ideales.
				</h4>
			</div>
		</div>
		<div class="row">
			<br>
			<div class="col-md-5 col-sm-5 text-center">
				<h4><b>Estado actual del terreno</b></h4>
				<div id="estadoTerreno">
					<img src="../static/img/{{ diagnostico }}" class="img-responsive" style="margin-top:20px;">
				</div>
			</div>
			<div class="col-md-5 col-sm-5 col-md-offset-1 text-center">
				<h4><b>Proyección de la enfermedad (60 días)</b></h4>
				<div id="estadoTerreno">
					<img src="../static/img/proyeccion_{{ imagenOriginal }}" class="img-responsive" style="margin-top:20px;">
				</div>				
			</div>
		</div>
		<div class="row">
			<div class="col-md-8 col-sm-8 col-md-offset-2">
				<br><br>
				<table rules="rows" style="position: relative;left: 11%;">
					<thead>
						<th></th>
						<th><h4><b>N° de plantas enfermas(*)</b></h4></th>
						<th><h4><b>Área enferma (m2)</b></h4></th>
					</thead>
					<tbody>
						<tr>
							<td style="text-align: left !important;"><h4><b>Estado Actual</b></h4></td>
							<td><h4>{{ numP_Plagas|floatformat:"0" }}</h4></td>
							<td><h4>{{ aPlagas|floatformat:"2" }}</h4></td>
						</tr>
						<tr>
							<td style="text-align: left !important;"><h4><b>Proyección (60 días)</b></h4></td>
							<td><h4>{{ numPlantas_prop|floatformat:"0" }}</h4></td>
							<td><h4>{{ area_prop|floatformat:"2" }}</h4></td>
						</tr>
					</tbody>
				</table>
				<br>
				<h4>De no tratarse la enfermedad de forma correcta, tu cultivo podrá sufrir un <b>incremento</b> del área afectada por la Roya del <b>{{ incremento_prop|floatformat:"0" }}%</b>.</h4>
			</div>
		</div>
		<!-- divider section -->
		<div class="container">
			<div class="row">
				<br><br>
				<div class="col-md-1 col-sm-1"></div>
				<div class="col-md-10 col-sm-10">
					<hr>
				</div>
				<div class="col-md-1 col-sm-1"></div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-12 col-sm-12 text-center">
				<h2>Variables ambientales</h2>
			</div>
		</div>
		<div class="row">
			<div class="col-md-5 col-sm-5 col-md-offset-1 text-center" style="position: relative;top:23px;left: -103px;">
				<div id="humedadDiv"></div>
			</div>
			<div class="col-md-5 col-sm-5 col-md-offset-1 text-center">
				<div id="tempm"></div>
			</div>
		</div>
		<div class="container">
			<div class="row">
				<br><br>
				<div class="col-md-1 col-sm-1"></div>
				<div class="col-md-10 col-sm-10">
					<hr>
				</div>
				<div class="col-md-1 col-sm-1"></div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-12 col-sm-12 text-center">
				<h2>Informe Costo-Producción</h2>
				<br><br>
				<h4>
					Tomando como referencia el estado actual de tu cultivo estos serían los Kg dividos en
					áreas sanas y afectadas, junto al estimado de ganacias que obtendrás por ellas.
				</h4>
			</div>
		</div>
		<div class="row">
			<br>
			<div class="col-md-2 col-sm-2 text-center">
				<p>Ingresa el precio por Kg de Café al que quieres estimar los ingresos brutos</p>
				<form>
				  <h5 style="display: inline-block;"><b>$</b></h5>
				  <input type="number" name="quantity" id="precioCafe" min="0">
				</form>
			</div>
			<div class="col-md-9 col-sm-9 col-md-offset-1 text-center">
				<table rules="rows">
					<thead>
						<th><h4><b>Kg de Café extraídos de plantas sanas(*)</b></h4></th>
						<th><h4><b>Kg de Café extraídos de plantas afectadas(*)</b></h4></th>
						<th><h4><b>Ingresos brutos por Café de plantas sanas</b></h4></th>
						<th><h4><b>Ingresos brutos por Café de plantas afectadas(**)</b></h4></th>
					</thead>
					<tbody>
						<tr>
							<td ><h4>{{ kilosSanas|floatformat:"2" }}</h4></td>
							<td><h4>{{ kilosAfectadas|floatformat:"2" }}</h4></td>
							<td><h4 id="gainSanas">0</h4></td>
							<td><h4 id="gainAfectadas">0</h4></td>
						</tr>
					</tbody>
				</table>
				<br><br>

				<h4><b>Total ingresos brutos por cosecha:</b></h4><h4 id="totalGanancias">$0</h4>
				<br><br>
				<p>(*) Se toma como referencia en promedio 2600Kg de Café por hectárea.</p>
				<p>(**) Se toma como referencia en promedio 1000Kg de Café por hectárea afectada.</p>
			</div>
		</div>
	</div>
</div>


<!-- divider section -->
<div class="container">
	<div class="row">
		<br><br>
		<div class="col-md-1 col-sm-1"></div>
		<div class="col-md-10 col-sm-10">
			<hr>
		</div>
		<div class="col-md-1 col-sm-1"></div>
	</div>
</div>

<!-- footer section -->
<footer>
	<div class="container">
		<div class="row">
			<div class="col-md-12 col-sm-12 text-center">
				<ul class="list-inline">
                    <li>
                        <a target="_blank" href="https://twitter.com/gia_usb" class="btn-social btn-outline"><i class="fa fa-fw fa-twitter"></i></a>
                    </li>
                    <li>
                        <a target="_blank" href="https://www.youtube.com/channel/UCfNP1LYdgX3qOONWqjGgGLA" class="btn-social btn-outline"><i class="fa fa-fw fa-youtube"></i></a>
                    </li>
                    <li>
                        <a target="_blank" href="https://github.com/GIA-USB" class="btn-social btn-outline"><i class="fa fa-fw fa-linkedin"></i></a>
                    </li>
                </ul>
				<p>Desarrollado por <a href="https://www.smartbasegroup.com" target="_blank">Smartbase Group</a></p>
			</div>
		</div>
	</div>
</footer>


<!-- javascript js -->	
<script src="../static/js/jquery.js"></script>
<script src="../static/js/bootstrap.min.js"></script>	
<script src="../static/js/nivo-lightbox.min.js"></script>
<script src="../static/js/smoothscroll.js"></script>
<script src="../static/js/jquery.nav.js"></script>
<script src="../static/js/isotope.js"></script>
<script src="../static/js/imagesloaded.min.js"></script>
<script src="../static/js/custom.js"></script>

<script type="text/javascript">
	/* Histograma de las variables de humedad */
	var trace1 = {
	  x: ['09-Octubre <br><br> Histórico', '09-Noviembre <br><br> Actual', '19-Noviembre <br><br> Proyectado'], 
	  y: [80.25339481, 79.15794923, 83], 
	  name: 'Humedad relativa máxima', 
	  type: 'bar'
	};

	var trace2 = {
	  x: ['09-Octubre <br><br> Histórico', '09-Noviembre <br><br> Actual', '19-Noviembre <br><br> Proyectado'], 
	  y: [53.59620713, 62.40539089, 52], 
	  name: 'Humedad relativa mínima', 
	  type: 'bar'
	};

	var data = [trace1, trace2];
	var layout = {
		title: "Promedio mensual de la <br> humedad relativa",
		barmode: 'group',
		xaxis: {
	    	showgrid: false, 
	    	zeroline: false
	  	}, 
	  	yaxis: {
	    	title: 'Porcentaje (%)', 
	    	showline: false
	 	},
	 	autosize: false,
	 	width: 600,
	 	height: 500,
	 	showlegend: true,
	 	legend: {"orientation": "h", y:-0.2}
	};

	Plotly.newPlot('humedadDiv', data, layout);


	/* Histograma de la variable de HumdrM
 	(Humeda Relativa MAX)  */
	/*var trace3 = {
	  y: [76, 80,71,80.25339481, 79.15794923, 83],
	  x: ['Marzo','Abril' ,'Mayo', 'Junio', 'Julio', 'Agosto'],
	  mode: 'lines+markers',
	  marker: {
	    color: 'rgb(164, 194, 244)',
	    size: 8
	  },
	  line: {
	    color: 'rgb(164, 194, 244)',
	    width: 1
	  },
	};

	var data = [trace3];

	var layout = {
	  title: 'Promedio mensual de la<br> humedad relativa máxima',
	  xaxis: {
	    title: 'Meses de estudio', 
	    showgrid: false, 
	    zeroline: false
	  }, 
	  yaxis: {
	    title: 'Porcentaje (%)', 
	    showline: false
	}};

	Plotly.newPlot('humdrmax', data, layout);

    /* Histograma de la variable de Humdrmin
	 ( (Humeda Relativa Minima))  */
	/*var trace3 = {
	  y: [58, 44,53,53.59620713, 62.40539089, 52],
	  x: ['Marzo','Abril' ,'Mayo', 'Junio', 'Julio', 'Agosto'],
	 mode: 'lines+markers',
	  //mode: 'markers',
	  marker: {
	    color: 'rgb(142, 124, 195)',
	    size: 8
	  },
	  line: {
	    color: 'rgb(128, 0, 128)',
	    width: 1
	  },
	};

	var data = [trace3];

	var layout = {
	  title: 'Promedio mensual de la<br> humedad relativa mínima',
	  xaxis: {
	    title: 'Meses de estudio', 
	    showgrid: false, 
	    zeroline: false
	  }, 
	  yaxis: {
	    title: 'Porcentaje (%)', 
	    showline: false
	  },
	};

	Plotly.newPlot('humdrmin', data, layout);*/
	/* Histograma de las variables de humedad */
	

	var trace3 = {
	  y: [21.44136132, 20.43768056, 22.13063096],
	  x: ['09-Octubre <br><br> Histórico', '09-Noviembre <br><br> Actual', '19-Noviembre <br><br> Proyectado'],
	 mode: 'lines+markers',
	  //mode: 'markers',
	  marker: {
	    color: 'rgb(128, 0, 128)',
	    size: 8
	  },
	  line: {
	    color: 'rgb(128, 0, 128)',
	    width: 1
	  }
	};

	var data = [trace3];

	var layout = {
	  title: 'Promedio mensual de la<br> temperatura media óptima',
	  xaxis: {
	    showgrid: false, 
	    zeroline: false
	  }, 
	  yaxis: {
	    title: 'Temperatura (°C)', 
	    showline: false
	  },
	  autosize: false,
	  width: 500,
	  height: 500
	};

	Plotly.newPlot('tempm', data, layout);


	//  Porcentaje de plantas de cafe afectado y sana
	var sanas = {{ plantasS|safe }};
	var afectadas = {{ plantasA|safe }};
	var data = [{
	  values: [sanas, afectadas],
	  labels: ['Plantas Sanas', 'Plantas afectadas' ],
	  domain: {
	    x: [0, .98]
	  },
	  name: 'Porcentaje de plantas',
	  hoverinfo: 'label+percent+name',
	  hole: .5,
	  type: 'pie',
	  marker: {'colors': [
	             'rgb(163, 197, 52)',  
	             'rgb(242, 175, 0)',
	            ]
	   		  },
	  }];
	
	var layout = {
	  title: 'Estado del cultivo de Café: 09-11-2017',
	};

	Plotly.newPlot('analisisTerreno', data, layout);

	//  Porcentaje de plantas de cafe afectado y sana
	var data = [{
	  values: [20, 80],
	  labels: ['Falta de nutrientes', 'Enfermedades y/o plagas'],
	  domain: {
	    x: [0, .98]
	  },
	  name: 'Plantas afectadas',
	  hoverinfo: 'label+percent+name',
	  hole: .5,
	  type: 'pie',
	  marker: {'colors': [
	  		'rgb(31, 119, 180)',
	  		'rgb(255, 127, 14)',
	  ]},
	}];

	var layout = {
	  title: 'Análisis terreno afectado: 09-11-2017',
	  showlegend: true,
	  
	};

	Plotly.newPlot('terrenoAfectado', data, layout);

</script>
<script type="text/javascript">
	/* Set the width of the side navigation to 250px */
	function openNav() {
	    document.getElementById("mySidenav").style.width = "250px";
	}

	/* Set the width of the side navigation to 0 */
	function closeNav() {
	    document.getElementById("mySidenav").style.width = "0";
	}
</script>
<script>
	$("#precioCafe").change(function(){
		var kgSanas = {{ kilosSanas|safe }};
		var kgAfectadas = {{ kilosAfectadas|safe }};
		var precio = $("#precioCafe").val();
		
		var gainSanas = (kgSanas*precio).toFixed(2);
		var gainAfectadas = (kgAfectadas*precio).toFixed(2);
		var totalGanancias = (kgSanas*precio+kgAfectadas*precio).toFixed(2);
		
		$("#gainSanas").text(gainSanas);
		$("#gainAfectadas").text(gainAfectadas);
		$("#totalGanancias").text(totalGanancias);
	});
</script>
</body>
</html>